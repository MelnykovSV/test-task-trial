{"version":3,"file":"static/js/198.7e40d77a.chunk.js","mappings":"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","sources":["pages/CatalogBody/CatalogBody.styled.jsx","pages/CatalogBody/CatalogBody.jsx"],"sourcesContent":["import styled from \"@emotion/styled\";\r\nimport { Button } from \"@mui/material\";\r\n\r\nexport const Container = styled.div``;\r\n\r\nexport const LoadMoreButton = styled(Button)`\r\n  display: block;\r\n  border: none;\r\n  margin: 0 auto;\r\n  margin-bottom: 140px;\r\n  background-color: ${({ theme }) => theme.bgMain};\r\n  cursor: pointer;\r\n  padding: 10px 20px;\r\n  color: ${({ theme }) => theme.accentMain};\r\n  font-family: \"Manrope\";\r\n  font-size: 16px;\r\n  font-weight: 500;\r\n  line-height: calc(24 / 16);\r\n  text-decoration-line: underline;\r\n`;\r\n\r\nexport const PageLoaderContainer = styled.div`\r\n  height: 300px;\r\n  position: relative;\r\n`;\r\n","import * as S from \"./CatalogBody.styled\";\r\nimport { useSearchParams } from \"react-router-dom\";\r\nimport { useState, useEffect, useRef } from \"react\";\r\nimport axios from \"axios\";\r\nimport { carsEndpoint, carsPerPage } from \"../../constants\";\r\nimport { CarsList } from \"../../components\";\r\nimport { generateQueryString } from \"../../helpers\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { selectCurrentPage } from \"../../redux/favoriteCars/carsSlice\";\r\nimport { incrementCurrentPage } from \"../../redux/favoriteCars/carsSlice\";\r\nimport StyledLoader from \"../../ui/StyledLoader/StyledLoader\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nconst CatalogBody = () => {\r\n  const dispatch = useDispatch();\r\n  const currentPage = useSelector(selectCurrentPage);\r\n  const [searchParams] = useSearchParams();\r\n  const make = searchParams.get(\"make\");\r\n  const rentalPrice = searchParams.get(\"rentalPrice\");\r\n  const minMileage = searchParams.get(\"minMileage\");\r\n  const maxMileage = searchParams.get(\"maxMileage\");\r\n\r\n  const queryString = generateQueryString({\r\n    make,\r\n    rentalPrice,\r\n    minMileage,\r\n    maxMileage,\r\n  });\r\n\r\n  console.log(queryString);\r\n\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [cars, setCars] = useState([]);\r\n  const [filteredCars, setFilteredCars] = useState([]);\r\n  const [isPageLast, setIsPageLast] = useState(true);\r\n  const isFirstRun = useRef(true);\r\n\r\n  useEffect(() => {\r\n    const filteredArray = filterArray(cars);\r\n\r\n    setFilteredCars(filterArray(filteredArray));\r\n    console.log(isFirstRun);\r\n\r\n    if (filteredArray.length === 0 && !isFirstRun.current) {\r\n      toast.warning(\"No result found!\");\r\n    }\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [cars]);\r\n\r\n  // useEffect(() => {\r\n  //   if (isFirstRun.current) {\r\n  //     isFirstRun.current = false;\r\n  //     return;\r\n  //   }\r\n  // });\r\n\r\n  const filterArray = (arr) => {\r\n    if (!rentalPrice && !minMileage && !maxMileage && arr.length === 0) {\r\n      return arr;\r\n    }\r\n    const filteredByRentalPrice = rentalPrice\r\n      ? arr.filter(\r\n          (item) =>\r\n            Number(item.rentalPrice.replace(\"$\", \"\")) <= Number(rentalPrice)\r\n        )\r\n      : [...arr];\r\n\r\n    const filteredByMinMileage = minMileage\r\n      ? filteredByRentalPrice.filter((item) => {\r\n          console.log(Number(item.mileage));\r\n          return Number(item.mileage) >= Number(minMileage);\r\n        })\r\n      : [...filteredByRentalPrice];\r\n\r\n    const filteredByMaxMileage = maxMileage\r\n      ? filteredByMinMileage.filter(\r\n          (item) => Number(item.mileage) <= Number(maxMileage)\r\n        )\r\n      : [...filteredByMinMileage];\r\n\r\n    return filteredByMaxMileage;\r\n  };\r\n\r\n  const fetchCarsData = async (page) => {\r\n    setIsLoading(true);\r\n    if (page === 1 || rentalPrice || minMileage || maxMileage) {\r\n      setCars([]);\r\n    }\r\n    try {\r\n      const response = await axios.get(\r\n        rentalPrice || minMileage || maxMileage\r\n          ? `${carsEndpoint}?page=1&limit=25${make ? `&make=${make}` : \"\"}`\r\n          : `${carsEndpoint}?page=${page}&limit=${carsPerPage}${\r\n              make ? `&make=${make}` : \"\"\r\n            }`\r\n      );\r\n\r\n      setIsLoading(false);\r\n      if (response.data.length === carsPerPage) {\r\n        setIsPageLast(false);\r\n      } else {\r\n        setIsPageLast(true);\r\n      }\r\n      if (page === 1) {\r\n        setCars([...response.data]);\r\n      } else {\r\n        setCars([...cars, ...response.data]);\r\n      }\r\n    } catch (error) {\r\n      setIsLoading(false);\r\n      toast.error(error.message);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchCarsData(currentPage);\r\n    if (isFirstRun.current) {\r\n      isFirstRun.current = false;\r\n    }\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [currentPage, make, rentalPrice, minMileage, maxMileage]);\r\n\r\n  const loadMoreHandler = () => {\r\n    dispatch(incrementCurrentPage());\r\n  };\r\n\r\n  return (\r\n    <S.Container>\r\n      <CarsList cars={filteredCars} />\r\n\r\n      {isLoading && (\r\n        <S.PageLoaderContainer>\r\n          <StyledLoader />\r\n        </S.PageLoaderContainer>\r\n      )}\r\n      {(isPageLast && !isLoading) || (\r\n        <S.LoadMoreButton onClick={loadMoreHandler}>Load more</S.LoadMoreButton>\r\n      )}\r\n    </S.Container>\r\n  );\r\n};\r\n\r\nexport default CatalogBody;\r\n"],"names":["Container","styled","div","_templateObject","_taggedTemplateLiteral","LoadMoreButton","Button","_templateObject2","_ref","theme","bgMain","_ref2","accentMain","PageLoaderContainer","_templateObject3","dispatch","useDispatch","currentPage","useSelector","selectCurrentPage","_useSearchParams","useSearchParams","searchParams","_slicedToArray","make","get","rentalPrice","minMileage","maxMileage","queryString","generateQueryString","console","log","_useState","useState","_useState2","isLoading","setIsLoading","_useState3","_useState4","cars","setCars","_useState5","_useState6","filteredCars","setFilteredCars","_useState7","_useState8","isPageLast","setIsPageLast","isFirstRun","useRef","useEffect","filteredArray","filterArray","length","current","toast","warning","arr","filteredByRentalPrice","filter","item","Number","replace","_toConsumableArray","filteredByMinMileage","mileage","fetchCarsData","_asyncToGenerator","_regeneratorRuntime","mark","_callee","page","response","wrap","_context","prev","next","axios","concat","carsEndpoint","carsPerPage","sent","data","t0","error","message","stop","_x","apply","arguments","_jsxs","S","children","_jsx","CarsList","StyledLoader","onClick","incrementCurrentPage"],"sourceRoot":""}